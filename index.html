<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<title>ScrapStats</title>

		<!-- Bootstrap -->
		<link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">

		<!--[if lt IE 9]>
		<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
		<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
		<![endif]-->

	</head>
	<body>
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-offset-2 col-md-8">
          <h1 class="text-center">ScrapStats</h1>
          <p class="lead text-center">Keep it simple, yo. This will be a short intro explaining the data that is being displayed and how to interact with it.</p>
          <ul class="icons clearfix">
            <li id="fruitveg">Fruits & Veggies</li>
            <li id="grain">Grains</li>
            <li id="meat">Meat</li>
            <li id="milk">Dairy</li>
            <li id="seafood">Seafood</li>
          </ul>
          <!-- This is where the d3 function lives -->
          <div class="house">
            <div id="vis-container"></div>
            <script type="text/javascript" src="../js/jquery-1.9.1.min.js"></script>
            <script type="text/javascript" src="../js/d3.min.js"></script>
            <script type="text/javascript">

            // global object
            // reset to clear pie
            var data = [];

            function drawPie(arg) {

              $("#vis-container").html("");

              d3.json("stats.json", function(error, json) {

                var color = d3.scale.category20c();

                data.push({
                  "label": json[arg].Label,
                  "value": json[arg]["Consumer Losses"]
                });

                var r = 250,
                  width = 600,
                  height = 600;

                var vis = d3.select("#vis-container")
                      .append("svg:svg")
                      .data([data])
                      .attr("width", width)
                      .attr("height", height)
                      .attr("id", "canvas")
                      .append("svg:g")
                      .attr("transform", "translate(" + r + "," + r + ")");

                var arc = d3.svg.arc()
                      .outerRadius(r);


                var pie = d3.layout.pie()
                      .value(function(d) {
                        return d.value;
                      });

                var arcs = vis.selectAll("g.slice")
                  .data(pie)
                  .enter()
                    .append("svg:g")
                    .attr("class", "slice");

                arcs.append("svg:path")
                  .attr("fill", function(d, i) { return color(i); })
                  .attr("d", arc);

                arcs.append("svg:text")
                  .attr("transform", function(d) {
                    d.innerRadius = 0;
                    d.outerRadius = r;
                     return "translate(" + arc.centroid(d) + ")";
                  })
                  .attr("text-anchor", "middle")
                  .text(function(d, i) { return data[i].label; });
              });
            }

            </script>
          </div>
          <footer>
            <p class="small text-center"><a href="#">Why we built ScrapStats</a>&nbsp;&nbsp;&#10084;&nbsp;&nbsp;<a href="#">Meet the team</a></p>
          </footer>
        </div>
      </div>
    </div>

    <!-- triggers to draw -->
    <script>
      $("#fruitveg").click(function(){
        drawPie('fruitveg');
      });
      $("#grain").click(function(){
        drawPie('grain');
      });
      $("#meat").click(function(){
        drawPie('meat');
      });
      $("#milk").click(function(){
        drawPie('milk');
      });
      $("#seafood").click(function(){
        drawPie('seafood');
      });

    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
	</body>
</html>
